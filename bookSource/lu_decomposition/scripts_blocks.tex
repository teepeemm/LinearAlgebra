
\subsection*{Block $LDU$ Explanation}

%%%Insert this to get the typewriter font so it looks like a real movie script
{\ttfamily
\fontdimen2\font=0.4em
\fontdimen3\font=0.2em
\fontdimen4\font=0.1em
\fontdimen7\font=0.1em
\hyphenchar\font=`\-


\hypertarget{scripts_lu_decomposition_blocks}{This video} explains how to do a block $LDU$ decomposition.
Firstly remember some key facts about block matrices: It is important that the blocks fit together properly.
For example, if we have matrices
$$
\begin{array}{c|c} \mbox{matrix}&\mbox{shape}\\\hline
X&r\times r\\
Y&r\times t\\
Z&t\times r\\
W& t\times t
\end{array}
$$
we could fit these together as a $(r+t)\times(r+t)$ square block matrix
$$
M=\left(\begin{array}{c|c}X&Y\\\hline Z&W\end{array}\right)\, .
$$
Matrix multiplication works for blocks just as for matrix entries:
$$
M^2 = \left(\begin{array}{c|c}X&Y\\\hline Z&W\end{array}\right)\left(\begin{array}{c|c}X&Y\\\hline Z&W\end{array}\right)
=\left(\begin{array}{c|c}X^2 + YZ&XY+YW\\\hline ZX+WZ&ZY+W^2\end{array}\right)\, .
$$
Now lets specialize to the case where the square matrix $X$ has an inverse. Then we can multiply out the following triple product of a lower triangular, a block diagonal and an
upper triangular matrix:
$$
\left(\begin{array}{c|c}I&0\\\hline ZX^{-1}&I\end{array}\right)\left(\begin{array}{c|c}X&0\\\hline 0&W-ZX^{-1}Y\end{array}\right)
\left(\begin{array}{c|c}I&X^{-1}Y\\\hline 0&I\end{array}\right)$$ $$=
\left(\begin{array}{c|c}X&0\\\hline Z&W-ZX^{-1}Y\end{array}\right)
\left(\begin{array}{c|c}I&X^{-1}Y\\\hline 0&I\end{array}\right)
$$ $$=
\left(\begin{array}{c|c}X&Y\\\hline ZX^{-1}Y+Z&W-ZX^{-1}Y\end{array}\right)
$$
$$
=\left(\begin{array}{c|c}X&Y\\\hline Z&W\end{array}\right)=M\, .
$$
This shows that the $LDU$ decomposition given in Section~\ref{LUdecomp} is correct.
} % Closing bracket for font

%\newpage
